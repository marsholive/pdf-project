<!DOCTYPE html>
<html>
<head>
  <title>Multi-Image to Multi-Page PDF</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body style="font-family:sans-serif; text-align:center; margin:2em;">

  <h1>Convert Multiple Images to PDF</h1>
  <input type="file" id="upload" accept="image/*" multiple />
  <br /><br />
  <button id="convertBtn">Convert to PDF</button>

  <script>
    const fileInput = document.getElementById("upload");
    const convertBtn = document.getElementById("convertBtn");

    convertBtn.addEventListener("click", async () => {
      if (!fileInput.files.length) return alert("Please upload at least one image.");

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const readFileAsDataURL = (file) => {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = (e) => resolve(e.target.result);
          reader.onerror = (e) => reject(e);
          reader.readAsDataURL(file);
        });
      };

      for (let i = 0; i < fileInput.files.length; i++) {
        const file = fileInput.files[i];
        const imgData = await readFileAsDataURL(file);

        if (i > 0) doc.addPage();

        // Get page dimensions
        const pageWidth = doc.internal.pageSize.getWidth();
        const pageHeight = doc.internal.pageSize.getHeight();

        // Create image element to get natural size
        const img = new Image();
        img.src = imgData;

        await new Promise((resolve) => {
          img.onload = resolve;
        });

        const margin = 15;
        const maxWidth = pageWidth - margin * 2;
        const maxHeight = pageHeight - margin * 2;

        let imgWidth = img.width;
        let imgHeight = img.height;

        // Scale to fit page keeping aspect ratio
        if (imgWidth > maxWidth) {
          const scale = maxWidth / imgWidth;
          imgWidth = maxWidth;
          imgHeight = imgHeight * scale;
        }
        if (imgHeight > maxHeight) {
          const scale = maxHeight / imgHeight;
          imgHeight = maxHeight;
          imgWidth = imgWidth * scale;
        }

        const x = (pageWidth - imgWidth) / 2;
        const y = (pageHeight - imgHeight) / 2;

        doc.addImage(imgData, 'JPEG', x, y, imgWidth, imgHeight);
      }

      doc.save("converted.pdf");
    });
  </script>
</body>
</html>
